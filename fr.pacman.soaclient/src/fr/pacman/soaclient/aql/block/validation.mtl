[module validation(	'http://www.obeonetwork.org/dsl/soa/4.0.0', 
					'http://www.obeonetwork.org/dsl/environment/3.0.0')/]



[import fr::pacman::core::aql::validation::common/]
[import fr::pacman::core::validation::PacmanValidatorsReport/]
				
[comment écriture du rapport de validation pour un fichier de modélisation (soa)./]
[comment pour les dtos on est pas relié directement à la base de données, doit on être plus souple sur les références ?/]
[template public validation (m : soa::System)]
  [for (e | m.eAllContents(environment::DTO))]
    [comment pas de dto avec un mot-clé java./]
    [if (e.name.isJavaKeyword())][e.add(e.err1())/][/if]
  [/for]
  [for (e | m.eAllContents(environment::Reference))]
    [comment pas de dto avec un mot-clé java./]
    [if (e.name.isJavaKeyword())][e.add(e.err2())/][/if]
  [/for]
  [for (e | m.eAllContents(soa::Service))]
    [comment pas de service avec un mot-clé java./]
    [if (e.name.isJavaKeyword())][e.add(e.err3())/][/if]
  [/for]
  [for (e | m.eAllContents(soa::Parameter))]
    [comment pas de paramètre avec un mot-clé java./]
    [if (e.name.isJavaKeyword())][e.add(e.err4())/][/if]
  [/for]
[/template]

[comment vérifie si le nom d'un élement correspond à un mot-clé java./]
[query public isJavaKeyword(s : String) : Boolean =
    s.toLower()
      .matches('abstract|assert|boolean|break|byte|case|catch|char|class|const|continue|'
              + 'default|do|double|else|enum|extends|final|finally|float|for|goto|if|'
              + 'implements|import|instanceof|int|interface|long|native|new|null|package|'
              + 'private|protected|public|return|short|static|strictfp|super|switch|'
              + 'synchronized|this|throw|throws|transient|try|void|volatile|while')
/]

[comment impossible de créer des éléments (objets) avec comme nom un mot-clé java./]
[query private err1 (e : environment::DTO) : String = 'RG_01@' + e.nameDto() + '@Présence de mot-clé java@Modifiez le nom de l\'élément'/]
  
[comment impossible de créer des éléments (objets) avec comme nom un mot-clé java./]
[query private err2 (e : environment::Reference) : String = 'RG_01@' + e.nameReference() + '@Présence de mot-clé java@Modifiez le nom de l\'élément'/]
  
[comment impossible de créer des éléments (objets) avec comme nom un mot-clé java./]
[query private err3 (e : soa::Service) : String = 'RG_01@' + e.nameService() + '@Présence de mot-clé java@Modifiez le nom de l\'élément'/]
  
[comment impossible de créer des éléments (objets) avec comme nom un mot-clé java./]
[query private err4 (e : soa::Parameter) : String = 'RG_01@' + e.nameParameter() + '@Présence de mot-clé java@Modifiez le nom de l\'élément'/]
